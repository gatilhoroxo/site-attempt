
<script>
// Navigation Sidebar - Registrar estado de navegação
(function() {
  'use strict';
  
  // Aguardar SidebarStateManager estar pronto
  function init() {
    if (!window.SidebarStateManager) {
      setTimeout(init, 50);
      return;
    }
    
    const navigationMode = document.getElementById('navigation-mode');
    const sidebarToggle = document.getElementById('sidebar-toggle');
    
    if (!navigationMode || !sidebarToggle) {
      console.error('Navigation elements not found');
      return;
    }
    
    // Registrar estado de navegação
    window.SidebarStateManager.registerState('navigation', {
      element: navigationMode,
      button: sidebarToggle,
      onActivate: function() {
        console.log('Navigation mode activated');
      },
      onDeactivate: function() {
        console.log('Navigation mode deactivated');
      }
    });
    
    // Verificar estado inicial
    const sidebarWasCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
    const savedState = localStorage.getItem('sidebarState');
    
    // Se sidebar não estava colapsada E não há outro estado salvo, ativar navegação
    if (!sidebarWasCollapsed && (!savedState || savedState === 'navigation' || savedState === 'null')) {
      setTimeout(() => {
        if (!window.SidebarStateManager.currentState) {
          window.SidebarStateManager.activateState('navigation');
          window.SidebarStateManager.currentState = 'navigation';
          // Garantir que sidebar está visível
          window.SidebarStateManager.sidebar.classList.remove('collapsed');
          window.SidebarStateManager.body.classList.remove('sidebar-collapsed');
        }
      }, 100);
    }
  }
  
  // Inicializar
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>